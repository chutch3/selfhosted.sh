# homelab.yaml.example - Configuration Template
# Copy this file to homelab.yaml and customize with your values
# Or use .env file for sensitive environment variables

version: "2.0"
deployment: docker_compose

environment:
  HOST_IP: 192.168.16.1
  DNS_SERVER: 192.168.86.1
  TZ: America/New_York
  UID: 1000
  GID: 1000
  BASE_DOMAIN: diyhub.dev
  WILDCARD_DOMAIN: "*.diyhub.dev"
  # Security sensitive variables - use .env file instead:
  # CF_Key: your_cloudflare_api_key
  # CF_Email: your_cloudflare_email
  ACME_SH_EMAIL: your_email@example.com
  ACME_OCSP: true
  NGINX_ENTRYPOINT_QUIET_LOGS: 1
  # Service API keys - use .env file for production:
  # EMBY_API_KEY: your_emby_api_key
  # HASS_TOKEN: your_homeassistant_long_lived_token
  # RADARR_API_KEY: your_radarr_api_key
  # SONARR_API_KEY: your_sonarr_api_key
  # DELUGE_PASSWORD: your_deluge_password
  # QBIT_USERNAME: admin
  # QBIT_PASSWORD: your_qbit_password
  # PROWLARR_API_KEY: your_prowlarr_api_key

machines:
  driver:
    host: localhost
    user: user
    labels:
      role: manager

services:
  actual:
    image: docker.io/actualbudget/actual-server:latest
    port: 5006
    storage: true
    enabled: true
    deploy: driver
    domain: actual.diyhub.dev
    overrides:
      docker_compose:
        volumes:
          - "${VOLUME_ACTUAL_DATA}:/data"

  cryptpad:
    image: promasu/cryptpad:version-2024.6.0
    port: 3000
    enabled: true
    deploy: driver
    domain: cryptpad.diyhub.dev
    overrides:
      docker_compose:
        volumes:
          - "${VOLUME_CRYPTPAD_FILES}:/cryptpad/datastore"
          - "${VOLUME_CRYPTPAD_CUSTOMIZATION}:/cryptpad/customize"

  homeassistant:
    image: ghcr.io/home-assistant/home-assistant:stable
    port: 8123
    enabled: true
    deploy: driver
    domain: homeassistant.diyhub.dev
    overrides:
      docker_compose:
        volumes:
          - "${VOLUME_HOMEASSISTANT_CONFIG}:/config"
          - "/etc/localtime:/etc/localtime:ro"
        privileged: true
        network_mode: host

  homepage:
    image: ghcr.io/gethomepage/homepage:latest
    port: 3000
    enabled: true
    deploy: driver
    domain: homepage.diyhub.dev
    overrides:
      docker_compose:
        volumes:
          - "${VOLUME_HOMEPAGE_CONFIG}:/app/config"
          - "/var/run/docker.sock:/var/run/docker.sock:ro"

  photoprism:
    image: photoprism/photoprism:latest
    port: 2342
    storage: true
    enabled: true
    deploy: driver
    domain: photoprism.diyhub.dev
    overrides:
      docker_compose:
        volumes:
          - "${VOLUME_PHOTOPRISM_CONFIG}:/photoprism/storage"
          - "${VOLUME_PHOTOPRISM_PHOTOS}:/photoprism/originals"
        security_opt:
          - seccomp:unconfined
          - apparmor:unconfined
        working_dir: "/photoprism"

  portainer_agent:
    image: portainer/agent:2.19.4
    port: 9001
    enabled: true
    deploy: driver
    overrides:
      docker_compose:
        volumes:
          - "/var/run/docker.sock:/var/run/docker.sock"
          - "/var/lib/docker/volumes:/var/lib/docker/volumes"
